<?xml version="1.0" encoding="UTF-8"?>
<graphml xmlns="http://graphml.graphdrawing.org/xmlns"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://graphml.graphdrawing.org/xmlns
     http://graphml.graphdrawing.org/xmlns/1.0/graphml.xsd">

    <key id="type" for="node" attr.name="type" attr.type="string"/>
    <key id="file_path" for="node" attr.name="file_path" attr.type="string"/>
    <key id="process_name" for="node" attr.name="process_name" attr.type="string"/>
    <key id="url_ip" for="node" attr.name="url_ip" attr.type="string"/>
    <key id="is_seed_node" for="node" attr.name="is_seed_node" attr.type="boolean"/>

    <key id="event_type" for="edge" attr.name="event_type" attr.type="string"/>
    <key id="sequence_num" for="edge" attr.name="sequence_num" attr.type="int"/>
    <key id="is_seed_edge" for="edge" attr.name="is_seed_edge" attr.type="boolean"/>

    <graph id="T1027" edgedefault="directed">
        <!-- Description: Leverage Cron for persistance or privilege escalation by add new tasks to crontab or modify existing cron tasks. -->
        <node id="n0">
            <data key="type">file</data>
            <data key="file_path">*.dat</data>
            <data key="is_seed_node">false</data>
        </node>
        <node id="n1">
            <data key="type">process</data>
            <data key="process_name">cat *.dat | base64 -d > *.sh</data>
            <data key="is_seed_node">true</data>
        </node>
        <node id="n2">
            <data key="type">process</data>
            <!-- <data key="process_name">chmod +x *.sh</data> -->
            <data key="process_name">.*/bin/bash</data>
            <data key="is_seed_node">true</data>
        </node>
        <node id="n3">
            <data key="type">process</data>
            <data key="process_name">*.sh</data>
            <data key="is_seed_node">false</data>
        </node>


        <edge source="n1" target="n0">
            <data key="event_type">read</data>
            <data key="sequence_num">1</data>
            <data key="is_seed_edge">true</data>
        </edge>
    </graph>
</graphml>